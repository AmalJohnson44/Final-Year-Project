<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Online Voting System">
  <title>Mayoral Election 2025</title>

  <!-- Bootstrap CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
</head>
<body>
  <!-- Navigation -->
  <nav class="custom-navbar navbar navbar-expand-md navbar-dark bg-dark" aria-label="Mayoral Election Navigation">
    <div class="container">
      <a class="navbar-brand" href="index.html" aria-label="Navigate to homepage">Ireland Votes</a>
      <div class="ms-auto">
        <a href="logout.html" class="btn btn-secondary btn-sm hover-item" aria-label="Logout from your account" data-voice="You are about to log out. Make sure to save your work.">Logout</a>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <div class="hero">
    <div class="container">
      <div class="row justify-content-center text-center">
        <div class="col-lg-8">
          <h1 class="display-3 fw-bold" data-voice="Welcome to Mayoral Election 2025">Welcome to Mayoral Election 2025</h1>
          <p class="mb-4" data-voice="Your voice matters! Participate in shaping the future of your city by casting your vote in the Mayoral Election.">Your voice matters! Participate in shaping the future of your city by casting your vote in the Mayoral Election.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Voter Information Section -->
  <div class="container my-5">
    <div class="row">
      <div class="col-lg-6 mb-4">
        <h2 class="fw-bold" data-voice="Voter Information">Voter Information</h2>
        <div id="voterDetails">
          <!-- Voter details will be dynamically loaded here -->
          <p data-voice="Voter Name"><strong>Name:</strong> <span id="voterName">Loading...</span></p>
          <p data-voice="Voter Constituency"><strong>Constituency:</strong> <span id="voterConstituency">Loading...</span></p>
          <p data-voice="Voter ID"><strong>Voter ID:</strong> <span id="voterID">Loading...</span></p>
        </div>
      </div>
      <div class="col-lg-6 text-center">
        <img src="images/roi_flag_map.png" alt="Map of Ireland" style="max-width:100%;">
      </div>
    </div>
  </div>

  <!-- Candidate Information Section -->
  <div class="container my-5">
    <h2 class="fw-bold text-center" data-voice="Candidate Information">Candidate Information</h2>
    <form id="voteForm">
      <div class="row">
        <div class="col-12">
          <ul class="list-group" id="candidateList">
            <!-- Dynamic Candidate List -->
            <script>
              const mayoralCandidates = [
                { id: "candidate1", name: "Candidate A", img: "images/candidateA.jpg" },
                { id: "candidate2", name: "Candidate B", img: "images/candidateB.jpg" },
                { id: "candidate3", name: "Candidate C", img: "images/candidateC.jpg" },
                { id: "candidate4", name: "Candidate D", img: "images/candidateD.jpg" },
                { id: "candidate5", name: "Candidate E", img: "images/candidateE.jpg" },
              ];
              document.write(
                mayoralCandidates.map(candidate => `
                  <li class="list-group-item d-flex align-items-center" data-voice="${candidate.name}">
                    <img src="${candidate.img}" alt="${candidate.name}" class="img-thumbnail me-3" style="width: 100px; height: auto;">
                    <span class="me-auto">${candidate.name}</span>
                    <input type="checkbox" id="${candidate.id}" name="votes" value="${candidate.name}" class="form-check-input me-3">
                    <label for="priority_${candidate.id}" class="me-2">Priority:</label>
                    <input type="number" id="priority_${candidate.id}" name="priority_${candidate.id}" min="1" max="5" class="form-control" style="width: 80px;" disabled>
                  </li>
                `).join('')
              );
            </script>
          </ul>
        </div>
      </div>
      <div class="text-center mt-4">
        <button type="submit" class="btn btn-success" data-voice="Submit Your Vote">Submit Your Vote</button>
      </div>
    </form>
  </div>

  <!-- Footer -->
  <footer class="footer-section">
    <div class="container">
      <p class="text-center">Â© 2024 Ireland Voting System. All rights reserved.</p>
    </div>
  </footer>

  <!-- Voice Over Toggle Button -->
  <div class="voice-over-toggle">
    <button id="voiceOverToggle" class="btn btn-primary">Turn Voice Over On</button>
  </div>

  <!-- Scripts -->
  <script src="js/bootstrap.bundle.min.js"></script>
  <script>
    // Voice Over Functionality
    let voiceOverEnabled = false;
    const synth = window.speechSynthesis;

    function speak(text) {
      if (voiceOverEnabled && synth && text) {
        synth.cancel(); // Stop any ongoing speech
        const utterance = new SpeechSynthesisUtterance(text);
        synth.speak(utterance);
      }
    }

    // Toggle Voice Over
    document.getElementById('voiceOverToggle').addEventListener('click', function() {
      voiceOverEnabled = !voiceOverEnabled;
      this.textContent = voiceOverEnabled ? 'Turn Voice Over Off' : 'Turn Voice Over On';
      if (voiceOverEnabled) {
        // Read the introduction when voice-over is turned on
        const introText = document.querySelector('.hero h1').getAttribute('data-voice') + ". " +
                          document.querySelector('.hero p').getAttribute('data-voice');
        speak(introText);
      } else {
        synth.cancel(); // Stop speech when voice-over is turned off
      }
    });

    // Add event listeners for voice over to static elements
    document.querySelectorAll('[data-voice]').forEach(element => {
      element.addEventListener('mouseover', function() {
        speak(this.getAttribute('data-voice'));
      });
      element.addEventListener('mouseout', function() {
        synth.cancel(); // Stop speech when cursor leaves the element
      });
    });

    // Add event listeners for dynamically generated candidate elements
    document.getElementById('candidateList').addEventListener('mouseover', function(event) {
      if (event.target.classList.contains('list-group-item')) {
        const candidateName = event.target.getAttribute('data-voice');
        speak(candidateName);
      }
    });

    // Add voice-over for priority selection
    document.querySelectorAll('input[name="votes"]').forEach(checkbox => {
      checkbox.addEventListener('change', function() {
        const priorityInput = document.getElementById(`priority_${this.id}`);
        if (this.checked) {
          priorityInput.disabled = false;
          speak(`${this.value} selected.`);
        } else {
          priorityInput.disabled = true;
          priorityInput.value = "";
        }
      });
    });

    // Fetch voter details from the database (mocked as an example)
    document.addEventListener("DOMContentLoaded", function() {
      // Simulating database fetch with a static object
      const voterData = {
        name: "Peter",
        constituency: "Dublin City",
        voterID: "67890DEF"
      };

      // Display voter details
      document.getElementById("voterName").textContent = voterData.name;
      document.getElementById("voterConstituency").textContent = voterData.constituency;
      document.getElementById("voterID").textContent = voterData.voterID;

      // Enable priority input when a candidate is selected
      document.querySelectorAll('input[name="votes"]').forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const priorityInput = document.getElementById(`priority_${this.id}`);
          if (this.checked) {
            priorityInput.disabled = false;
          } else {
            priorityInput.disabled = true;
            priorityInput.value = "";
          }
        });
      });
    });

    // Handle vote submission
    document.getElementById("voteForm").addEventListener("submit", function(event) {
      event.preventDefault();
      const selectedCandidates = Array.from(document.querySelectorAll('input[name="votes"]:checked')).map(input => {
        const priority = document.getElementById(`priority_${input.id}`).value;
        return { candidate: input.value, priority: priority || null };
      });

      if (selectedCandidates.length === 0) {
        alert("Please select at least one candidate to vote for.");
        return;
      }

      console.log("Vote submitted:", selectedCandidates);
      alert("Thank you for voting! Your vote has been recorded.");
    });
  </script>
</body>
</html>